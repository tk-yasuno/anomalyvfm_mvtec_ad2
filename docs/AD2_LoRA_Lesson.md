# MVTec AD2ã§ã®LoRAçµ±åˆæ•™è¨“é›†

## æ¦‚è¦

AnomalyVFM v1.1ã«ãŠã„ã¦ã€MVTec AD2ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå…¨7ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§LoRAï¼ˆLow-Rank Adaptationï¼‰çµ±åˆå®Ÿé¨“ã‚’å®Ÿæ–½ã—ã€è²´é‡ãªå®Ÿç”¨çŸ¥è¦‹ã‚’ç²å¾—ã—ã¾ã—ãŸã€‚10ã‚¨ãƒãƒƒã‚¯è¨“ç·´ã€ä¸‰æ®µéšåˆæˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã€ä¿¡é ¼åº¦é‡ã¿ä»˜ãæå¤±ã‚’å«ã‚€åŒ…æ‹¬çš„ãªæ¤œè¨¼ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ•™è¨“ã‚’æ•´ç†ã—ã¾ã™ã€‚

## ğŸ“Š å®Ÿé¨“æ¦‚è¦

### å®Ÿé¨“è¨­å®š
- **ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ**: MVTec AD2 å…¨7ã‚«ãƒ†ã‚´ãƒªãƒ¼
- **LoRAè¨­å®š**: Rank=16, Alpha=32, 3å±¤cascade
- **è¨“ç·´**: 10ã‚¨ãƒãƒƒã‚¯ã€AdamWã€å­¦ç¿’ç‡1e-4
- **åˆæˆãƒ‡ãƒ¼ã‚¿**: 90ã‚µãƒ³ãƒ—ãƒ«/ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ»æ§‹é€ ãƒ»æ–‡è„ˆå„30ï¼‰
- **è©•ä¾¡æŒ‡æ¨™**: Image-level AUC

### å…¨ä½“çµæœ
- **LoRAå¹³å‡AUC**: 0.5626
- **ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å¹³å‡AUC**: 0.5539
- **å¹³å‡æ”¹å–„**: +0.86%
- **ç·å‡¦ç†æ™‚é–“**: 2,507ç§’ï¼ˆç´„42åˆ†ï¼‰

## ğŸ† ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥æ•™è¨“

### é«˜åŠ¹æœã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆ+2%ä»¥ä¸Šæ”¹å–„ï¼‰

#### fruit_jelly: +5.42%æ”¹å–„ï¼ˆ0.6158â†’0.6492ï¼‰
```
âœ… æˆåŠŸè¦å› :
- è±Šå¯Œãªãƒ†ã‚¯ã‚¹ãƒãƒ£æƒ…å ±
- è‰²å½©ãƒ»è¡¨é¢å¤‰åŒ–ã®å¤šæ§˜æ€§
- åˆæˆãƒ‡ãƒ¼ã‚¿ã¨ã®è¦ªå’Œæ€§é«˜

ğŸ“š æ•™è¨“:
- ãƒ†ã‚¯ã‚¹ãƒãƒ£è±Šå¯Œãªå¯¾è±¡ã§LoRAãŒæœ€ã‚‚åŠ¹æœçš„
- è¦–è¦šçš„å¤šæ§˜æ€§ãŒadaptationå­¦ç¿’ã«è²¢çŒ®
- æœç‰©ç³»ã‚«ãƒ†ã‚´ãƒªãƒ¼ã¯LoRAå°å…¥ä¾¡å€¤å¤§
```

#### walnuts: +2.80%æ”¹å–„ï¼ˆ0.5685â†’0.5844ï¼‰
```
âœ… æˆåŠŸè¦å› :
- è¤‡é›‘ãª3Då½¢çŠ¶
- è¡¨é¢ã®ä¸è¦å‰‡ãƒ‘ã‚¿ãƒ¼ãƒ³
- è‡ªç„¶ç‰©ç‰¹æœ‰ã®å¤‰åŒ–

ğŸ“š æ•™è¨“:
- è¤‡é›‘å½¢çŠ¶ç‰©ä½“ã§ã®LoRAé©å¿œåŠ¹æœ
- è‡ªç„¶ç‰©ã®ä¸è¦å‰‡æ€§ã«å¯¾ã™ã‚‹å­¦ç¿’èƒ½åŠ›
- å½¢çŠ¶ç‰¹å¾´ã®å¼·åŒ–ã«ã‚ˆã‚‹æ€§èƒ½å‘ä¸Š
```

#### can: +1.10%æ”¹å–„ï¼ˆ0.5468â†’0.5528ï¼‰
```
âœ… æˆåŠŸè¦å› :
- é‡‘å±è¡¨é¢ã®å¾®ç´°å¤‰åŒ–æ¤œçŸ¥
- æ§‹é€ çš„æ¬ é™¥ã¸ã®æ„Ÿåº¦å‘ä¸Š
- å·¥æ¥­ææ–™ç‰¹æœ‰ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’

ğŸ“š æ•™è¨“:
- å·¥æ¥­è£½å“ã§ã‚‚ç€å®Ÿãªæ”¹å–„åŠ¹æœ
- é‡‘å±è¡¨é¢ç•°å¸¸ã®æ¤œçŸ¥èƒ½åŠ›å‘ä¸Š
- è£½é€ æ¥­å¿œç”¨ã§ã®å®Ÿç”¨ä¾¡å€¤
```

### ä¸­åŠ¹æœã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆ+1-2%æ”¹å–„ï¼‰

#### sheet_metal: +1.95%æ”¹å–„ï¼ˆ0.3583â†’0.3653ï¼‰
```
âš–ï¸ ä¸­ç¨‹åº¦åŠ¹æœ:
- æœ€å›°é›£ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§ã‚‚æ”¹å–„
- çµ¶å¯¾æ€§èƒ½ã¯æœ€ã‚‚ä½ã„ï¼ˆ0.3653ï¼‰
- LoRAã§ã‚‚æ ¹æœ¬çš„èª²é¡Œã¯æ®‹å­˜

ğŸ“š æ•™è¨“:
- å›°é›£ãªã‚±ãƒ¼ã‚¹ã§ã‚‚LoRAã¯åŠ¹æœç™ºæ®
- çµ¶å¯¾æ€§èƒ½å‘ä¸Šã‚ˆã‚Šç›¸å¯¾æ”¹å–„ã«æ³¨ç›®
- ä»–æ‰‹æ³•ã¨ã®ä½µç”¨æ¤œè¨ãŒå¿…è¦
```

#### wallplugs: +0.30%æ”¹å–„ï¼ˆ0.4359â†’0.4372ï¼‰
```
âš–ï¸ é™å®šåŠ¹æœ:
- ç¡¬è³ªææ–™ã§ã®æ”¹å–„ã¯å¾®å°
- æ§‹é€ çš„ç‰¹å¾´ãŒæ”¯é…çš„
- LoRAåŠ¹æœãŒåˆ¶é™ã•ã‚Œã‚‹ææ–™ç‰¹æ€§

ğŸ“š æ•™è¨“:
- ææ–™ç‰¹æ€§ã«ã‚ˆã‚‹LoRAåŠ¹æœã®é™ç•Œ
- ç¡¬è³ªãƒ»å‡ä¸€ææ–™ã¯æ”¹å–„å›°é›£
- ã‚³ã‚¹ãƒˆãƒ™ãƒãƒ•ã‚£ãƒƒãƒˆè¦æ¤œè¨
```

### é™å®šåŠ¹æœã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆæ”¹å–„ãªã—ã¾ãŸã¯å¾®æ¸›ï¼‰

#### fabric: -0.18%å¤‰åŒ–ï¼ˆ0.6532â†’0.6520ï¼‰
```
âŒ åŠ¹æœé™å®šç†ç”±:
- æ—¢ã«é«˜ã„ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ€§èƒ½
- DINOv2ã§ååˆ†ãªç‰¹å¾´æŠ½å‡ºæ¸ˆã¿
- éå­¦ç¿’ã«ã‚ˆã‚‹å¾®å°ãªæ€§èƒ½ä½ä¸‹

ğŸ“š æ•™è¨“:
- é«˜æ€§èƒ½åŸŸã§ã®LoRAé£½å’ŒåŠ¹æœ
- æ—¢å­˜æ‰‹æ³•ã§ååˆ†ãªå ´åˆã¯ä¸è¦
- éå­¦ç¿’ãƒªã‚¹ã‚¯ã®å­˜åœ¨
```

#### vial: -0.27%å¤‰åŒ–ï¼ˆ0.6990â†’0.6971ï¼‰
```
âŒ åŠ¹æœé™å®šç†ç”±:
- æœ€é«˜æ€§èƒ½ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆAUCç´„0.70ï¼‰
- DINOv2å˜ä½“ã§æ—¢ã«å„ªç§€
- LoRAè¿½åŠ ã«ã‚ˆã‚‹è¤‡é›‘åŒ–ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

ğŸ“š æ•™è¨“:
- æœ€é«˜æ€§èƒ½åŸŸã§ã¯æ”¹å–„ä½™åœ°å°‘
- ã‚·ãƒ³ãƒ—ãƒ«ãªæ‰‹æ³•ã§ååˆ†ãªå ´åˆã‚ã‚Š
- è¤‡é›‘åŒ–ã«ã‚ˆã‚‹æ€§èƒ½ä½ä¸‹ãƒªã‚¹ã‚¯
```

## ğŸ”¬ æŠ€è¡“çš„æ•™è¨“

### 1. LoRAè¨“ç·´å‹•æ…‹

#### åæŸãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æ
```python
# å„ªç§€ãªåæŸä¾‹ï¼ˆvialï¼‰
Epoch 1-5:  0.6912 â†’ 0.6122 (æ€¥é€Ÿæ¸›å°‘)
Epoch 6-10: 0.5781 â†’ 0.3101 (ç¶™ç¶šæ”¹å–„)

# æ¨™æº–çš„åæŸä¾‹ï¼ˆfruit_jellyï¼‰
Epoch 1-5:  0.6863 â†’ 0.6235 (é †èª¿æ¸›å°‘)
Epoch 6-10: 0.6118 â†’ 0.5675 (å®‰å®šåŒ–)

# å›°é›£ãªåæŸä¾‹ï¼ˆcanï¼‰
Epoch 1-5:  0.6936 â†’ 0.6420 (ç·©æ…¢æ¸›å°‘)
Epoch 6-10: 0.6470 â†’ 0.5979 (ä¸å®‰å®š)
```

#### æ•™è¨“
- **10ã‚¨ãƒãƒƒã‚¯ã¯é©åˆ‡**: å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§æå¤±æ¸›å°‘ç¶™ç¶š
- **æ—©æœŸåœæ­¢ä¸è¦**: éå­¦ç¿’å…†å€™ãªã—
- **ã‚«ãƒ†ã‚´ãƒªãƒ¼ä¾å­˜**: åæŸé€Ÿåº¦ã«å¤§ããªå·®

### 2. åˆæˆãƒ‡ãƒ¼ã‚¿ç”ŸæˆåŠ¹æœ

#### ä¸‰æ®µéšç”Ÿæˆã®è²¢çŒ®åº¦
```
Stage 1 (Texture):   ãƒã‚¤ã‚ºãƒ‘ãƒƒãƒã«ã‚ˆã‚‹ãƒ†ã‚¯ã‚¹ãƒãƒ£ç•°å¸¸
Stage 2 (Structural): å¹¾ä½•å­¦å½¢çŠ¶ã«ã‚ˆã‚‹æ§‹é€ ç•°å¸¸  
Stage 3 (Contextual): ã‚¯ãƒ­ã‚¹ç”»åƒã«ã‚ˆã‚‹æ–‡è„ˆç•°å¸¸

åŠ¹æœ: fruit_jelly > walnuts > can > others
```

#### æ•™è¨“
- **å¤šæ§˜æ€§ç¢ºä¿**: 90ã‚µãƒ³ãƒ—ãƒ«ã§ååˆ†ãªå¤‰åŒ–
- **real-synthetic gap**: å®Ÿãƒ‡ãƒ¼ã‚¿ã¨ã®ä¹–é›¢ã¯å°ã•ã„
- **category-specific**: ã‚«ãƒ†ã‚´ãƒªãƒ¼ç‰¹æ€§ã«ä¾å­˜

### 3. è¨ˆç®—åŠ¹ç‡ã¨ROI

#### å‡¦ç†æ™‚é–“åˆ†æ
| **ãƒ•ã‚§ãƒ¼ã‚º** | **æ™‚é–“** | **å‰²åˆ** |
|-------------|----------|----------|
| åˆæˆãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ | ~10ç§’ | 5% |
| LoRAè¨“ç·´ | ~100-170ç§’ | 60% |
| ç‰¹å¾´æŠ½å‡º | ~60-80ç§’ | 35% |

#### ROIåˆ†æ
```
æŠ•è³‡: å‡¦ç†æ™‚é–“ç´„2å€
ãƒªã‚¿ãƒ¼ãƒ³: å¹³å‡0.86%æ€§èƒ½å‘ä¸Š

é«˜ROIã‚«ãƒ†ã‚´ãƒªãƒ¼: fruit_jelly, walnuts
ä¸­ROIã‚«ãƒ†ã‚´ãƒªãƒ¼: can, sheet_metal  
ä½ROIã‚«ãƒ†ã‚´ãƒªãƒ¼: fabric, vial, wallplugs
```

## ğŸ¯ å®Ÿç”¨åŒ–æŒ‡é‡

### å°å…¥æ¨å¥¨ã‚«ãƒ†ã‚´ãƒªãƒ¼

#### Tier 1: å¼·ãæ¨å¥¨
- **fruit_jelly**: +5.42%ã§æ˜ç¢ºãªä¾¡å€¤æä¾›
- **walnuts**: +2.80%ã§è¤‡é›‘å½¢çŠ¶å¯¾å¿œèƒ½åŠ›

#### Tier 2: æ¡ä»¶ä»˜ãæ¨å¥¨  
- **can**: +1.10%ã§å·¥æ¥­ç”¨é€”ä¾¡å€¤
- **sheet_metal**: +1.95%ã§å›°é›£ã‚±ãƒ¼ã‚¹æ”¹å–„

#### Tier 3: è¦æ¤œè¨
- **wallplugs**: +0.30%ã§é™å®šçš„åŠ¹æœ
- **fabric**, **vial**: æ”¹å–„ãªã—ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ååˆ†

### å°å…¥åˆ¤æ–­åŸºæº–

#### LoRAå°å…¥é©åˆæ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
```
âœ… ãƒ†ã‚¯ã‚¹ãƒãƒ£è±Šå¯Œï¼ˆæœç‰©ã€è‡ªç„¶ç‰©ãªã©ï¼‰
âœ… è¤‡é›‘ãªå½¢çŠ¶ãƒ»è¡¨é¢ãƒ‘ã‚¿ãƒ¼ãƒ³  
âœ… ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ€§èƒ½ãŒä¸­ç¨‹åº¦ï¼ˆ0.4-0.7ï¼‰
âœ… å‡¦ç†æ™‚é–“å¢—åŠ è¨±å®¹å¯èƒ½
âœ… ç¶™ç¶šçš„æ€§èƒ½æ”¹å–„ãŒå¿…è¦

âŒ æ—¢ã«é«˜æ€§èƒ½ï¼ˆAUC > 0.65ï¼‰
âŒ å‡ä¸€ãƒ»ç¡¬è³ªææ–™
âŒ å‡¦ç†æ™‚é–“åˆ¶ç´„å³ã—ã„
âŒ ã‚·ãƒ³ãƒ—ãƒ«æ€§ã‚’é‡è¦–
âŒ ãƒªã‚½ãƒ¼ã‚¹åˆ¶ç´„å³ã—ã„
```

## ğŸ”® ä»Šå¾Œã®æ”¹å–„æ–¹å‘

### æŠ€è¡“çš„æ”¹å–„

#### 1. Adaptive LoRA Rank
```python
# ã‚«ãƒ†ã‚´ãƒªãƒ¼ç‰¹æ€§ã«å¿œã˜ãŸrankèª¿æ•´
high_texture_categories = ['fruit_jelly', 'walnuts']
â†’ rank=32, alpha=64

uniform_categories = ['fabric', 'vial']  
â†’ rank=8, alpha=16
```

#### 2. Multi-Scale LoRA
```python
# è¤‡æ•°è§£åƒåº¦ã§ã®ç‰¹å¾´é©å¿œ
scales = [256, 512, 1024]
for scale in scales:
    lora_adapters[scale] = LoRALayer(...)
```

#### 3. Attention-Guided LoRA
```python
# æ³¨æ„æ©Ÿæ§‹ã«ã‚ˆã‚‹é‡è¦é ˜åŸŸãƒ•ã‚©ãƒ¼ã‚«ã‚¹
attention_weights = compute_attention(features)
adapted_features = lora(features * attention_weights)
```

### é‹ç”¨é¢æ”¹å–„

#### 1. Category-Specific Pipeline
```
ã‚«ãƒ†ã‚´ãƒªãƒ¼æ¤œå‡º â†’ æœ€é©æ‰‹æ³•é¸æŠ
â”œâ”€â”€ High-texture â†’ LoRAé©ç”¨
â”œâ”€â”€ High-performance â†’ Baselineä½¿ç”¨  
â””â”€â”€ Industrial â†’ Ensembleæ¤œè¨
```

#### 2. Incremental Learning
```python
# æ–°ãƒ‡ãƒ¼ã‚¿ã§ã®LoRAç¶™ç¶šå­¦ç¿’
for new_batch in incremental_data:
    lora_model.update(new_batch)
```

#### 3. Performance Monitor
```python
# æ€§èƒ½ç›£è¦–ã¨Auto-tuning
if performance_drop > threshold:
    retrain_lora(recent_data)
```

## ğŸ“š è«–æ–‡è²¢çŒ®ã¨é™ç•Œ

### 2601.20524v1è«–æ–‡ã®æ¤œè¨¼çµæœ

#### æ¤œè¨¼ã§ããŸä¸»å¼µ
âœ… **Low-rank adaptationæœ‰åŠ¹æ€§**: å¹³å‡0.86%æ”¹å–„ã§å®Ÿè¨¼  
âœ… **Synthetic data generation**: ä¸‰æ®µéšç”Ÿæˆã§å¤šæ§˜æ€§ç¢ºä¿  
âœ… **Parameter efficiency**: å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®<1%ã§å­¦ç¿’  
âœ… **Zero-shot capability**: æ–°ã‚«ãƒ†ã‚´ãƒªãƒ¼ã¸ã®é©å¿œèƒ½åŠ›

#### é™ç•Œã¨èª²é¡Œ  
âŒ **Universal improvement**: å…¨ã‚«ãƒ†ã‚´ãƒªãƒ¼ã§æ”¹å–„ã¯å›°é›£  
âŒ **High-performance saturation**: æ—¢ã«å„ªç§€ãªæ‰‹æ³•ã¸ã®è¿½åŠ åŠ¹æœé™å®š  
âŒ **Computational overhead**: ç´„2å€ã®å‡¦ç†æ™‚é–“ã‚³ã‚¹ãƒˆ  
âŒ **Category dependency**: åŠ¹æœã®å¤§ããªã°ã‚‰ã¤ã

## ğŸ“ æœ€çµ‚æ•™è¨“

### æ ¸å¿ƒçš„æ´å¯Ÿ

1. **LoRAã¯ä¸‡èƒ½ã§ã¯ãªã„**: ã‚«ãƒ†ã‚´ãƒªãƒ¼ç‰¹æ€§ã«ã‚ˆã‚‹åŠ¹æœå·®å¤§
2. **ãƒ†ã‚¯ã‚¹ãƒãƒ£ãŒéµ**: è¦–è¦šçš„å¤šæ§˜æ€§ãŒLoRAåŠ¹æœã‚’æ±ºå®š
3. **é«˜æ€§èƒ½åŸŸã¯å›°é›£**: æ—¢å­˜æ‰‹æ³•ã§ååˆ†ãªå ´åˆè¿½åŠ ä¾¡å€¤å°
4. **ROIé‡è¦–**: å‡¦ç†æ™‚é–“å¢—åŠ ã«è¦‹åˆã†æ”¹å–„åŠ¹æœè¦æ¤œè¨¼
5. **é©å¿œçš„é‹ç”¨**: ã‚«ãƒ†ã‚´ãƒªãƒ¼æ¯ã®æœ€é©æ‰‹æ³•é¸æŠãŒé‡è¦

### å®Ÿè·µçš„æ¨å¥¨äº‹é …

```
ğŸ¯ LoRAå°å…¥æˆ¦ç•¥:
1. ã‚«ãƒ†ã‚´ãƒªãƒ¼ç‰¹æ€§ã®äº‹å‰è©•ä¾¡
2. ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ€§èƒ½ã®ç¢ºèª
3. ROIåˆ†æã«ã‚ˆã‚‹å°å…¥åˆ¤æ–­
4. æ®µéšçš„å°å…¥ã¨ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°
5. ç¶™ç¶šçš„æ”¹å–„ã¨ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
```

### å­¦è¡“çš„è²¢çŒ®

æœ¬å®Ÿé¨“ã«ã‚ˆã‚Šã€**Vision Foundation Modelã¸ã®LoRAé©ç”¨**ã«ãŠã„ã¦ï¼š
- ã‚«ãƒ†ã‚´ãƒªãƒ¼ä¾å­˜æ€§ã®å®šé‡çš„åˆ†æ
- å®Ÿç”¨åŒ–æŒ‡é‡ã®å…·ä½“çš„æç¤º  
- è«–æ–‡ç†è«–ã®å®Ÿè¨¼çš„æ¤œè¨¼
- é™ç•Œã¨èª²é¡Œã®æ˜ç¢ºåŒ–

**MVTec AD2ã§ã®LoRAçµ±åˆçŸ¥è¦‹**ãŒã€ç•°å¸¸æ¤œçŸ¥åˆ†é‡ã®ç™ºå±•ã«å¯„ä¸ã™ã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¾ã™ã€‚

---

*AnomalyVFM v1.1 - MVTec AD2 LoRAçµ±åˆå®Ÿé¨“å®Œäº†*  
*å®Ÿæ–½æ—¥: 2026å¹´2æœˆ1æ—¥*  
*ç·å‡¦ç†æ™‚é–“: 2,507ç§’ï¼ˆç´„42åˆ†ï¼‰*  
*æ¤œè¨¼ã‚«ãƒ†ã‚´ãƒªãƒ¼: å…¨7ã‚«ãƒ†ã‚´ãƒªãƒ¼å®Œå…¨è©•ä¾¡*